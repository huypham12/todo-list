extends ../layouts/default.pug

block content
  .container.mt-5
    //- Header cá»§a trang
    .d-flex.justify-content-between.align-items-center.mb-4
      h1.text-dark.mb-0 Todo List
      a.btn.btn-success(href='/add-task') Add New Task

    //- Náº¿u cÃ³ tasks
    if tasks && tasks.length
      .row.g-4
        each task in tasks
          .col-md-4
            .card.h-100.shadow-sm
              //- Card header: mÃ u thay Ä‘á»•i tÃ¹y theo tráº¡ng thÃ¡i task
              if task.status === 'completed'
                .card-header.bg-success.text-white
                  h5.mb-0= task.title
              else
                .card-header.bg-primary.text-white
                  h5.mb-0= task.title

              //- Card body chá»©a thÃ´ng tin task
              .card-body.text-dark
                if task.description
                  p.card-text= task.description
                p.card-text 
                  small.text-muted
                    | ðŸ“… Due Date: 
                    strong= task.dueDate ? task.dueDate.toLocaleDateString() : 'N/A'
                p.card-text 
                  small.text-muted
                    | ðŸ•’ Created At: 
                    strong= task.createdAt ? task.createdAt.toLocaleDateString() : 'N/A'
                if task.priority
                  p.card-text.mb-0 
                    | ðŸ”¥ Priority: 
                    span.badge.bg-info.text-dark= task.priority.charAt(0).toUpperCase() + task.priority.slice(1)


              //- Card footer vá»›i nÃºt hÃ nh Ä‘á»™ng
              .card-footer.bg-light
                .d-flex.justify-content-between.align-items-center
                  if task.status !== 'completed'
                    form(method="POST", action='/complete/' + task._id +'?_method=PATCH')
                      button.btn.btn-sm.btn-outline-success(type="submit") Mark as Completed
                  else
                    span.text-success.fw-bold Completed
                  
                  .btn-group
                    a.btn.btn-sm.btn-outline-primary(href='/edit/' + task._id) Edit

                    form(
                      method="POST"
                      action="/delete/" + task._id +'?_method=DELETE'
                      style='display:inline;'
                      )
                      input(type='hidden' name='_method' value='DELETE')
                      button.btn.btn-sm.btn-outline-danger(type='submit' onclick="return confirm('Are you sure?')") Delete


    else
      .text-center.mt-5
        p.text-muted No tasks found.
